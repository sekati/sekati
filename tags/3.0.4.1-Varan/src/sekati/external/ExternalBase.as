/** * sekati.external.ExternalBase * @version 1.1.0 * @author jason m horwitz | sekati.com * Copyright (C) 2008 jason m horwitz, Sekat LLC. All Rights Reserved. * Released under the MIT License: http://www.opensource.org/licenses/mit-license.php */package sekati.external {	import flash.external.ExternalInterface;	import flash.net.URLRequest;	import flash.net.navigateToURL;	import flash.system.Capabilities;	import sekati.validators.FlashValidator;		/**	 * Advanced ExternalInterface helpers, wrappers & utilities.	 */	public class ExternalBase {		/*** @private */		private static var _isJavascriptReady : Boolean = false;		/**		 * Evaluate the application instance to insure an external call can be place successfully:<ul>		 * <li><code>ExternalInterface.isAvailable</code></li>		 * <li><code>FlashValidator.isBrowser</code></li>		 * <li><code>body.onLoad</code></li></ul> 		 */		public static function get isReady() : Boolean {			// optimized to return if we've already been thru these evals			if(_isJavascriptReady) return true;						// if available and in browser test for the body.onload			if(ExternalInterface.available && FlashValidator.isBrowser) {				// test for the body.onLoad				var js : String = "function( ) { return true; }";				_isJavascriptReady = ExternalInterface.call( js );			}					return _isJavascriptReady;		}		/**		 * Check if a javascript external asset is installed (and that <code>ExternalInterface</code> is available & the swf is running in browser)		 * @param jsObj 	the javascript object or method to check for.		 * @return 			<code>true</code> if asset is available for use, <code>false</code> if not.		 */		public static function isExternalAsset(jsObj : String) : Boolean {			if(isReady) {				var installed : Boolean = ExternalInterface.call( "function(){ return typeof " + jsObj + " != 'undefined' }" );				return installed;			} else { 				return false;				}		}		/**		 * Creates an anonymous function wrapper to execute complex javascript within.		 * @param jsCode javascript method code sans <code>function(){ ... }</code> wrapping.		 * @return the javascript method calls return		 * @example <listing version="3.0">		 * 	var test : Boolean = ExternalBase.anonymousCall( "var b = true; return b;" ); // creates, executes: "function(){ var b = true; return b; };"		 * 	trace( test );		 * </listing>		 */		public static function anonymousCall(jsCode : String) : * {			if(isReady) {				var js : String = "function( ) { " + jsCode + " }";				return ExternalInterface.call( js );			}		}		/**		 * Javascript alert.		 */		public static function alert(msg : String) : void {			ExternalInterface.call( 'alert', msg );		}		/**		 * Javascript resize window.		 */		public static function resizeWindow(w : Number, h : Number) : void {			navigateToURL( new URLRequest( "javascript:top.resizeTo(" + w + "," + h + ")" ) );		}		/**		 * Javascript shake window.		 */		public static function shakeWindow(amount : Number) : void {			navigateToURL( new URLRequest( "javascript:function shakewin(n){if(parent.moveBy){for(i = 10;i > 0;i--){for(j = n;j > 0;j--){parent.moveBy(0,i);parent.moveBy(i,0);parent.moveBy(0,-i);parent.moveBy(-i,0);}}}};shakewin(" + amount + ");void(0)" ) );		}		/**		 * Javascript change status message.		 */		public static function status(msg : String) : void {			navigateToURL( new URLRequest( "javascript:if(typeof(this.href) != 'undefined') window.status = '" + msg + "' + ' URL: ' + this.href;else return false;void(0)" ) );		}		/**		 * Javascript pop centered window.		 */		public static function centerPop(wURL : String, wName : String, w : Number, h : Number, scr : Boolean) : void {			var cx : Number = Math.round( (Capabilities.screenResolutionX / 2) - (w / 2) );			var cy : Number = Math.round( (Capabilities.screenResolutionY / 2) - (h / 2) );			navigateToURL( new URLRequest( "javascript:NewWindow=window.open('" + wURL + "','" + wName + "','width=" + w + ",height=" + h + ",left=" + cx + ",top=" + cy + ",screenX=" + cx + ",screenY=" + cy + ",toolbar=no,location=no,scrolling=" + scr + ",directories=no,scrollbars=" + scr + ",status=no,statusbar=no,resizable=no,fullscreen=no'); NewWindow.focus(); void(0);" ) );		}		/**		 * JsBase Static Constructor		 */		public function ExternalBase() {			throw new Error( "JsBase is a static class and cannot be instantiated." );		}			}}